# rsa 高位攻击基础
# https://sagecell.sagemath.org/

import gmpy2
n = 26406507468595611843852094067483173843988114465094045314324958205247973393878612589146897816881236818219902539975703710689353618174826904300589643161784341674436810639999244652231756242284615955258973430337702733454791782484002773967293198343866259490519754466626455660967042613249021854707331393440280088268816341057924652807723419166490363777181753297185283416885627445213950857480287818564281651822264024891956284486733856518809532470029519647769749231421957169481281821885757924521580543834665554242403238567286205389138437021157096962185096308108489101554724344868500500476691994206988217768341711716527866730487
c = 22371088752722216457725632164373582195669473128756299754645443284929524768654545905154985577175225182544638209286885657892360668965805613727315024761409924679131145149936406239774150607378706790494820180586939668429812955766507811860718575149988809217701964019618239260041070894375952033566803105327100696642244951676616707205397327491933042019560545721027871057909242509336729865025061616686254481161431063503607378134616485979961926628954536592552923269161255759846497309277397441639921544384778106116567555705005440627393593876072210594939647990615797269482726733444406876986888296295032722008287447468255108089357
e = 65537
px:"(p>>256)<<256" = 159945952275533485818121954231313618960321976049710904254772419907677971914439101482974923293074598678164025819370654132149566696084245679106109087142916286461708005676333840438629476722637189134626565206159794947442549588155962485884562239895738265024295739578695834796427810095412842888401159276765814718464
kbits = 256

def get_info(e, n, px, c, kbits):
    PR.<x> = PolynomialRing(Zmod(n))
    f = px + x
    x0 = f.small_roots(X=2^kbits, beta=0.4)
    p = int(px + x0[0])
    q = n // p
    d = gmpy2.invert(e, (p-1)*(q-1))
    m = int(pow(c, d, n))
    return m

m = get_info(e, n, px, c, kbits)
print(m)
info = bytes.fromhex(hex(m)[2:])
print(info)